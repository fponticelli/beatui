# Tailwind Distribution & Exports Strategy

## Objectives
- Ship two CSS consumption modes: a purged standalone bundle and a Tailwind-native component layer.
- Provide ergonomic entrypoints for Tailwind preset/plugin usage without fragmenting the package namespace.
- Keep backwards compatibility for existing `@tempots/beatui/css` consumers while guiding them toward the new structure.

## Output Layout
The build pipeline should write the following artifacts into `packages/beatui/dist`:

```
dist/
├── css/
│   ├── beatui-standalone.css      # Purged + namespaced standalone CSS (replaces current beatui.css)
│   └── beatui-components.css      # Tailwind component layer (no base/utilities)
├── tailwind/
│   ├── index.mjs                 # ESM bundle exporting preset + token helpers
│   ├── index.cjs                 # CommonJS wrapper
│   ├── preset.mjs               # Alias pointing to the preset factory (ESM)
│   └── preset.cjs               # CommonJS alias for the preset
├── tailwind.d.ts                  # Barrel typing re-exporting Tailwind symbols
├── types/tailwind/…               # Type declarations emitted by `tsc`
└── beatui.css                     # Temporary compatibility copy pointing to css/beatui-standalone.css
```

Notes:
- The legacy `dist/beatui.css` remains as a thin wrapper that `@import`s `css/beatui-standalone.css` to avoid breaking existing import paths.
- `css/beatui-components.css` is generated via the Tailwind CLI; the build script writes a temporary config that loads the BeatUI preset and produces the components layer. It currently renders an empty sheet until Tailwind-first component rewrites land.
- Tailwind runtime helpers (`preset`/`plugin`) live under `dist/tailwind` to keep imports predictable and support dual ESM/CJS requirements.

## Export Map
Update `packages/beatui/package.json` exports once the new files exist:

```json
{
  "exports": {
    ".": {
      "types": "./dist/types/index.d.ts",
      "import": "./dist/index.es.js",
      "require": "./dist/index.cjs.js",
      "default": "./dist/index.es.js"
    },
    "./css": "./dist/beatui.css",
    "./tailwind": {
      "types": "./dist/tailwind.d.ts",
      "import": "./dist/tailwind/index.mjs",
      "require": "./dist/tailwind/index.cjs",
      "default": "./dist/tailwind/index.mjs"
    },
    "./tailwind/preset": {
      "types": "./dist/types/tailwind/preset.d.ts",
      "import": "./dist/tailwind/preset.mjs",
      "require": "./dist/tailwind/preset.cjs",
      "default": "./dist/tailwind/preset.mjs"
    },
    "./tailwind/tokens": {
      "types": "./dist/types/tailwind/tokens.d.ts",
      "import": "./dist/tailwind/preset.mjs",
      "require": "./dist/tailwind/preset.cjs",
      "default": "./dist/tailwind/preset.mjs"
    },
    "./package.json": "./package.json"
  }
}
```

## Consumer Guidance
- **Standalone CSS**: `import '@tempots/beatui/css';` (legacy) or `import '@tempots/beatui/css/standalone';` for explicit access.
- **Tailwind users**: `import preset from '@tempots/beatui/tailwind/preset'` inside `tailwind.config.ts` (or via the new v4 `@config` directive) and include `import '@tempots/beatui/css/components';` within the app’s Tailwind pipeline.
- **Utility plugin**: `const beatui = require('@tempots/beatui/tailwind')` provides a default export bundling the preset + utilities (`beatui.preset`, `beatui.plugin`).

## Follow-up Tasks
- [x] Update build scripts to emit the new folder structure and copy compatibility files. _(Handled by `packages/beatui/scripts/build-tailwind-entries.mjs`.)_
- [x] Extend the TypeScript build to generate `dist/types/tailwind/*` definitions. _(Generated by existing `tsconfig.build.json` output.)_
- [ ] Wire Tailwind CLI into CI once `tailwindcss` is installed in the workspace (the build script currently no-ops if the binary is missing).
- [ ] Add unit smoke tests ensuring both CSS entrypoints resolve and the preset registers expected layers.
- [ ] Document upgrade steps in the public migration guide.
